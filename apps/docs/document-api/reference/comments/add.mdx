---
title: comments.add
sidebarTitle: comments.add
description: Generated reference for comments.add
---

{/* GENERATED FILE: DO NOT EDIT. Regenerate via `pnpm run docapi:sync`. */}

> Alpha: Document API is currently alpha and subject to breaking changes.

## Summary

- Operation ID: `comments.add`
- API member path: `editor.doc.comments.add(...)`
- Mutates document: `yes`
- Idempotency: `non-idempotent`
- Supports tracked mode: `no`
- Supports dry run: `no`
- Deterministic target resolution: `yes`

## Pre-apply throws

- `TARGET_NOT_FOUND`
- `COMMAND_UNAVAILABLE`
- `CAPABILITY_UNAVAILABLE`
- `INVALID_TARGET`

## Non-applied failure codes

- `INVALID_TARGET`
- `NO_OP`

## Input schema

```json
{
  "additionalProperties": false,
  "allOf": [
    {
      "not": {
        "required": [
          "target",
          "blockId"
        ]
      }
    },
    {
      "not": {
        "required": [
          "target",
          "start"
        ]
      }
    },
    {
      "not": {
        "required": [
          "target",
          "end"
        ]
      }
    },
    {
      "if": {
        "required": [
          "start"
        ]
      },
      "then": {
        "required": [
          "blockId",
          "end"
        ]
      }
    },
    {
      "if": {
        "required": [
          "end"
        ]
      },
      "then": {
        "required": [
          "blockId",
          "start"
        ]
      }
    },
    {
      "if": {
        "required": [
          "blockId"
        ]
      },
      "then": {
        "required": [
          "start",
          "end"
        ]
      }
    }
  ],
  "anyOf": [
    {
      "required": [
        "target"
      ]
    },
    {
      "required": [
        "blockId",
        "start",
        "end"
      ]
    }
  ],
  "properties": {
    "blockId": {
      "description": "Block ID for block-relative range targeting.",
      "type": "string"
    },
    "end": {
      "description": "End offset within the block identified by blockId.",
      "minimum": 0,
      "type": "integer"
    },
    "start": {
      "description": "Start offset within the block identified by blockId.",
      "minimum": 0,
      "type": "integer"
    },
    "target": {
      "additionalProperties": false,
      "properties": {
        "blockId": {
          "type": "string"
        },
        "kind": {
          "const": "text"
        },
        "range": {
          "additionalProperties": false,
          "properties": {
            "end": {
              "type": "integer"
            },
            "start": {
              "type": "integer"
            }
          },
          "required": [
            "start",
            "end"
          ],
          "type": "object"
        }
      },
      "required": [
        "kind",
        "blockId",
        "range"
      ],
      "type": "object"
    },
    "text": {
      "type": "string"
    }
  },
  "required": [
    "text"
  ],
  "type": "object"
}
```

## Output schema

```json
{
  "oneOf": [
    {
      "additionalProperties": false,
      "properties": {
        "inserted": {
          "items": {
            "oneOf": [
              {
                "additionalProperties": false,
                "properties": {
                  "entityId": {
                    "type": "string"
                  },
                  "entityType": {
                    "const": "comment"
                  },
                  "kind": {
                    "const": "entity"
                  }
                },
                "required": [
                  "kind",
                  "entityType",
                  "entityId"
                ],
                "type": "object"
              },
              {
                "additionalProperties": false,
                "properties": {
                  "entityId": {
                    "type": "string"
                  },
                  "entityType": {
                    "const": "trackedChange"
                  },
                  "kind": {
                    "const": "entity"
                  }
                },
                "required": [
                  "kind",
                  "entityType",
                  "entityId"
                ],
                "type": "object"
              }
            ]
          },
          "type": "array"
        },
        "removed": {
          "items": {
            "oneOf": [
              {
                "additionalProperties": false,
                "properties": {
                  "entityId": {
                    "type": "string"
                  },
                  "entityType": {
                    "const": "comment"
                  },
                  "kind": {
                    "const": "entity"
                  }
                },
                "required": [
                  "kind",
                  "entityType",
                  "entityId"
                ],
                "type": "object"
              },
              {
                "additionalProperties": false,
                "properties": {
                  "entityId": {
                    "type": "string"
                  },
                  "entityType": {
                    "const": "trackedChange"
                  },
                  "kind": {
                    "const": "entity"
                  }
                },
                "required": [
                  "kind",
                  "entityType",
                  "entityId"
                ],
                "type": "object"
              }
            ]
          },
          "type": "array"
        },
        "success": {
          "const": true
        },
        "updated": {
          "items": {
            "oneOf": [
              {
                "additionalProperties": false,
                "properties": {
                  "entityId": {
                    "type": "string"
                  },
                  "entityType": {
                    "const": "comment"
                  },
                  "kind": {
                    "const": "entity"
                  }
                },
                "required": [
                  "kind",
                  "entityType",
                  "entityId"
                ],
                "type": "object"
              },
              {
                "additionalProperties": false,
                "properties": {
                  "entityId": {
                    "type": "string"
                  },
                  "entityType": {
                    "const": "trackedChange"
                  },
                  "kind": {
                    "const": "entity"
                  }
                },
                "required": [
                  "kind",
                  "entityType",
                  "entityId"
                ],
                "type": "object"
              }
            ]
          },
          "type": "array"
        }
      },
      "required": [
        "success"
      ],
      "type": "object"
    },
    {
      "additionalProperties": false,
      "properties": {
        "failure": {
          "additionalProperties": false,
          "properties": {
            "code": {
              "enum": [
                "INVALID_TARGET",
                "NO_OP"
              ]
            },
            "details": {},
            "message": {
              "type": "string"
            }
          },
          "required": [
            "code",
            "message"
          ],
          "type": "object"
        },
        "success": {
          "const": false
        }
      },
      "required": [
        "success",
        "failure"
      ],
      "type": "object"
    }
  ]
}
```

## Success schema

```json
{
  "additionalProperties": false,
  "properties": {
    "inserted": {
      "items": {
        "oneOf": [
          {
            "additionalProperties": false,
            "properties": {
              "entityId": {
                "type": "string"
              },
              "entityType": {
                "const": "comment"
              },
              "kind": {
                "const": "entity"
              }
            },
            "required": [
              "kind",
              "entityType",
              "entityId"
            ],
            "type": "object"
          },
          {
            "additionalProperties": false,
            "properties": {
              "entityId": {
                "type": "string"
              },
              "entityType": {
                "const": "trackedChange"
              },
              "kind": {
                "const": "entity"
              }
            },
            "required": [
              "kind",
              "entityType",
              "entityId"
            ],
            "type": "object"
          }
        ]
      },
      "type": "array"
    },
    "removed": {
      "items": {
        "oneOf": [
          {
            "additionalProperties": false,
            "properties": {
              "entityId": {
                "type": "string"
              },
              "entityType": {
                "const": "comment"
              },
              "kind": {
                "const": "entity"
              }
            },
            "required": [
              "kind",
              "entityType",
              "entityId"
            ],
            "type": "object"
          },
          {
            "additionalProperties": false,
            "properties": {
              "entityId": {
                "type": "string"
              },
              "entityType": {
                "const": "trackedChange"
              },
              "kind": {
                "const": "entity"
              }
            },
            "required": [
              "kind",
              "entityType",
              "entityId"
            ],
            "type": "object"
          }
        ]
      },
      "type": "array"
    },
    "success": {
      "const": true
    },
    "updated": {
      "items": {
        "oneOf": [
          {
            "additionalProperties": false,
            "properties": {
              "entityId": {
                "type": "string"
              },
              "entityType": {
                "const": "comment"
              },
              "kind": {
                "const": "entity"
              }
            },
            "required": [
              "kind",
              "entityType",
              "entityId"
            ],
            "type": "object"
          },
          {
            "additionalProperties": false,
            "properties": {
              "entityId": {
                "type": "string"
              },
              "entityType": {
                "const": "trackedChange"
              },
              "kind": {
                "const": "entity"
              }
            },
            "required": [
              "kind",
              "entityType",
              "entityId"
            ],
            "type": "object"
          }
        ]
      },
      "type": "array"
    }
  },
  "required": [
    "success"
  ],
  "type": "object"
}
```

## Failure schema

```json
{
  "additionalProperties": false,
  "properties": {
    "failure": {
      "additionalProperties": false,
      "properties": {
        "code": {
          "enum": [
            "INVALID_TARGET",
            "NO_OP"
          ]
        },
        "details": {},
        "message": {
          "type": "string"
        }
      },
      "required": [
        "code",
        "message"
      ],
      "type": "object"
    },
    "success": {
      "const": false
    }
  },
  "required": [
    "success",
    "failure"
  ],
  "type": "object"
}
```
